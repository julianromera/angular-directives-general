!function(){"use strict";var e;try{e=angular.module("uix-multiselect")}catch(l){e=null}e||(angular.module("uix-multiselect.services",["ngResource","ngAnimate"]),angular.module("uix-multiselect.controllers",[]),angular.module("uix-multiselect.directives",[]),angular.module("uix-multiselect.constants",[]),angular.module("uix-multiselect",["uix-multiselect.services","uix-multiselect.controllers","uix-multiselect.directives","uix-multiselect.constants"]));var t=function(e){var l=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(t){var n=t.match(l);if(!n)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+t+'".');return{itemName:n[3],source:e(n[4]),viewMapper:e(n[2]||n[1]),modelMapper:e(n[1])}}}},n=function(e,l,t,n,i,a,c,r){return{restrict:"EA",require:["ngModel","?^form"],link:function(o,s,u,d){var f,m=d[0],p=(d.length>1&&"undefined"!=typeof d[1]?d[1]:null,e(u.ngModel).assign,r.parse(u.options)),h=u.multiple?o.$eval(u.multiple):!1,g=u.autoFocus?o.$eval(u.autoFocus):!1,v=u.complexModels?o.$eval(u.complexModels):!1,b=u.enableFilter?o.$eval(u.enableFilter):!0,k=u.enableCheckAll?o.$eval(u.enableCheckAll):!0,x=u.enableUncheckAll?o.$eval(u.enableUncheckAll):!0,A=u.header?u.header:"Select",y=u.selectedHeader?u.selectedHeader:"selected",w=u.selectLimit?o.$eval(u.selectLimit):0,V=u.selectLimitUseFiltered?o.$eval(u.selectLimitUseFiltered):!0,M=u.filterPlaceholder?u.filterPlaceholder:"Filter ..",S=u.checkAllLabel?u.checkAllLabel:"Check all",P=u.uncheckAllLabel?u.uncheckAllLabel:"Uncheck all",C=u.appendToBody?o.$eval(u.appendToBody):!1,F=!1,L=o.$new(!0),T=(u.change||angular.noop,angular.element("<multiselect-popup></multiselect-popup>")),O="multiselect-"+L.$id+"-"+Math.floor(1e4*Math.random()),E=200,U=function(e){return e.checked===!0},q=function(){var e=t("filter")(L.items,L.searchText);return e},H=function(){for(var e=0;e<L.items.length;e++)if(L.items[e].checked)return L.items[e].label;return A},_=function(){var e=!1,l=!1,t=!1;if(0!==w&&h){var n=L.items.filter(U);l=n.length===w,t=n.length>w,e=n.length<w}else e=!0,l=!1;return L.maxSelected=l||t,l||e},I=function(){var e=A;if(N(m.$modelValue))return L.header=e;if(h){var l=m.$modelValue instanceof Array;e=l&&m.$modelValue.length>1?m.$modelValue.length+" "+y:H()}else e=H();L.header=e},N=function(e){if(!e)return!0;if(!v&&e)return!1;if(e.length&&e.length>0)return!1;for(var l in e)if(e[l])return!1;return!0},B=function(){L.items.length=0;var e=p.source(o);if(angular.isDefined(e)){for(var l=m.$modelValue instanceof Array,t=0;t<e.length;t++){var n={};n[p.itemName]=e[t];var i=p.modelMapper(n),a=l?-1!==m.$modelValue.indexOf(i.toString())||-1!==m.$modelValue.indexOf(i):!N(m.$modelValue)&&m.$modelValue===i,c={label:p.viewMapper(n),model:e[t],checked:a};L.items.push(c)}I()}},D=function(e){e.checked?L.uncheckAll():(L.uncheckAll(),e.checked=!0),z(!1)},R=function(e){e.checked?(e.checked=!1,_()):L.maxSelected||(e.checked=_()),z(!0)},j=function(e){var l;if(v)l=e.model;else{var t={};t[p.itemName]=e.model,l=p.modelMapper(t)}return l},z=function(e){var l;e?(l=[],angular.forEach(L.items,function(e){if(e.checked)if(v)l.push(e.model);else{var t={};t[p.itemName]=e.model,l.push(p.modelMapper(t))}})):angular.forEach(L.items,function(e){if(e.checked){if(v)return l=e.model,!1;var t={};return t[p.itemName]=e.model,l=p.modelMapper(t),!1}}),L.triggered=!0,m.$setViewValue(l)},G=function(e){if(angular.isArray(e)){var l,t,n=[],i=[],a=[];for(t=0;t<L.items.length;t++)a.push(j(L.items[t])),i.push(t);for(l=0;l<e.length;l++)for(t=0;t<a.length;t++)if(angular.equals(a[t],e[l])){n.push(L.items[t]);var c=i.indexOf(t);i.splice(c,1);break}for(l=0;l<n.length;l++)n[l].checked=!0;for(l=0;l<i.length;l++)L.items[i[l]].checked=!1}else angular.forEach(L.items,function(l){var t=j(l);return angular.equals(t,e)?(l.checked=!0,!1):void 0})},J=function(){L.position=C?c.offset(Q):c.position(s),L.position.top+=Q.prop("offsetHeight")},K=function(){L.moveInProgress||(L.moveInProgress=!0,L.$digest()),f&&l.cancel(f),f=l(function(){L.isOpen&&J(),L.moveInProgress=!1,L.$digest()},E)};L.items=[],L.header=A,L.multiple=h,L.disabled=!1,L.filterPlaceholder=M,L.checkAllLabel=S,L.uncheckAllLabel=P,L.selectLimit=w,L.enableFilter=b,L.enableCheckAll=k,L.enableUncheckAll=x,L.searchText={label:""},L.isAutoFocus=g,L.appendToBody=C,L.moveInProgress=!1,L.popupId=O,L.recalculatePosition=J,L.isModelValueSet=!1,o.$on("$destroy",function(){L.$destroy(),n.unbind("click",L.clickHandler),C&&$("#"+O).remove()}),C&&(angular.element(a).bind("resize",K),n.find("body").bind("scroll",K)),(u.required||u.ngRequired)&&(F=!0),u.$observe("required",function(e){F=e}),L.$watch(function(){return e(u.ngDisabled)(o)},function(e){L.disabled=e}),L.$watch(function(){return e(u.multiple)(o)},function(e){h=e||!1}),L.$watch(function(){return p.source(o)},function(e){angular.isDefined(e)&&B()},!0),L.$watch(function(){return m.$modelValue},function(e){if(!L.triggered)if(angular.isDefined(e)){var l=e instanceof Array;(l&&0===e.length||!l)&&L.uncheckAll(),G(e),L.isModelValueSet=!0}else L.isModelValueSet&&(L.uncheckAll(),L.isModelValueSet=!1);I(),_(),m.$setValidity("required",L.valid()),L.triggered=!1},!0),B();var Q=i(T)(L);s.append(Q),l(function(){J()},100),L.valid=function(){if(!F)return!0;var e=m.$modelValue;return angular.isArray(e)&&e.length>0||!angular.isArray(e)&&null!==e},L.checkAll=function(){if(h){var e=L.items,l=0;if(V&&(e=q(),angular.forEach(e,function(e){e.checked=!1}),l=L.items.filter(U).length),0>=w||e.length<w-l)angular.forEach(e,function(e){e.checked=!0});else{angular.forEach(e,function(e){e.checked=!1});for(var t=0;w-l>t;t++)e[t].checked=!0;L.maxSelected=!0}z(!0)}},L.uncheckAll=function(){var e=V?q():L.items;angular.forEach(e,function(e){e.checked=!1}),_(),h&&z(!0)},L.select=function(e){h===!1?(D(e),L.toggleSelect()):R(e)},L.clearFilter=function(){L.searchText.label=""}}}},i=function(e){return{restrict:"E",replace:!0,require:["^ngModel","?^form"],templateUrl:"template/multiselect/multiselectPopup.html",link:function(l,t){var n=t.find(".dropdown-menu");n.attr("id",l.popupId),l.appendToBody&&e.find("body").append(n);var i=function(c){a(c.target,t.find(c.target.tagName))||l.appendToBody&&a(c.target,n.find(c.target.tagName))||(t.removeClass("open"),l.isOpen=!1,e.unbind("click",i),l.$apply())},a=function(e,l){for(var t=0;t<l.length;t++)if(e===l[t])return!0;return!1};l.clickHandler=i,l.isVisible=!1,l.isHeightChanged=!0;var c,r;l.toggleSelect=function(){t.hasClass("open")||l.isOpen?(t.removeClass("open"),l.isOpen=!1,e.unbind("click",i)):(t.addClass("open"),l.isOpen=!0,e.bind("click",i),l.isAutoFocus&&l.focus(),l.recalculatePosition());var n=t.parent(),a=$(window).scrollTop(),o=$(window).height(),s=$(window).width(),u=t.find("ul:first");if(l.isHeightChanged&&(c=u.height(),r=u.width(),l.isHeightChanged=!1),0>=c&&0>=r){var d=$(u).clone().css("position","fixed").css("top","0").css("left","-10000px").appendTo(n).removeClass("ng-hide").show();c=d.height(),r=d.width(),d.remove(),d=null}var f=t.offset().top+t.height()-a,m=o-t.height()-t.offset().top+a;if(c>m&&f>c?l.dropup=!0:l.dropup=!1,t.offset().left+r>=s){l.isOffRight=!0;var p=-1*(t.offset().left+r-s+10);u.css("left",p.toString()+"px")}else l.isOffRight=!1,u.css("left","0")},l.focus=function(){if(l.enableFilter){var e=t.find("input")[0];e.focus()}}}}};angular.module("uix-multiselect").run(["$templateCache",function(e){e.put("template/multiselect/multiselectPopup.html",'<div class="btn-group" ng-class="{ dropup: dropup, single: !multiple }"><button type="button" class="btn btn-default dropdown-toggle" ng-click="toggleSelect()" ng-disabled="disabled" ng-class="{\'has-error\': !valid()}"><span class="pull-left" ng-bind="header"></span><span class="caret pull-right"></span></button><ul class="dropdown-menu multi-select-popup" ng-show="isOpen && !moveInProgress" ng-style="{ true: {top: position.top +\'px\', left: position.left +\'px\'}, false: {}}[appendToBody]" style="display: block;" role="listbox" aria-hidden="{{!isOpen}}"><li ng-if="enableFilter" class="filter-container"><div class="form-group has-feedback filter"><input class="form-control" type="text" ng-model="searchText.label" placeholder="{{ filterPlaceholder }}" /><span class="glyphicon glyphicon-remove-circle form-control-feedback" ng-click="clearFilter()"></span></div></li><li ng-show="multiple && (enableCheckAll || enableUncheckAll)"><button ng-if="enableCheckAll" type="button" class="btn-link btn-small" ng-click="checkAll()"><i class="icon-ok"></i> {{ checkAllLabel }}</button><button ng-if="enableUncheckAll" type="button" class="btn-link btn-small" ng-click="uncheckAll()"><i class="icon-remove"></i> {{ uncheckAllLabel }}</button></li><li ng-show="maxSelected"><small>Selected maximum of </small><small ng-bind="selectLimit"></small></li><li ng-repeat="i in items | filter:searchText"><a ng-click="select(i);"><i class="glyphicon" ng-class="{\'glyphicon-ok\': i.checked, \'glyphicon-none\': !i.checked}"></i><span ng-bind="i.label"></span></a></li></ul></div>')}]),t.$inject=["$parse"],n.$inject=["$parse","$timeout","$filter","$document","$compile","$window","$uibPosition","multiselectParser"],i.$inject=["$document"],angular.module("uix-multiselect.services").factory("multiselectParser",t),angular.module("uix-multiselect.directives").directive("multiselectPopup",i),angular.module("uix-multiselect.directives").directive("multiselect",n)}();
